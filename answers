7 Задание

7.1 Сначала в Hive необходимо создать таблицу в виде файла parquet, а затем в существующую таблицу писать данные. Запрос на создание таблицы:
CREATE TABLE parquet_test (
 field1 string,
 field2 int,
 field3 timestamp, 
 field4 int)
STORED AS PARQUET;

7.2 Ответьте на вопрос ,что такое repartition и что такое coalesce и в чём разница?
repartition позволяет уменьшить или увеличить число партиций, coalesce только уменьшить. При уменьшении разница заключается в том, что repatition
случайным образом помещает данные в указанное число партиций, все данные перемешиваются. Coalesce выбирает из существующих партиций указанное число и к
ним присоединяет все оставшиеся. Таким образом уменьшается объём передаваемых по сети данных.

7.3 в каких запросах и почему разбитие на partitions уменьшает время выполнения.
Если известно, что ответом на запрос будут данные, которые содержатся в оределённой partition, то запрос быдет выполняться быстрее.
Например, данные разделены по дате и нас интересуют данные за опреденную дату. Нет необходимости искать среди всего набора, достаточно осуществить поиск
в соответствующей partition.

7.4 объяснить почему в паркет из стриминга писать плохо
Parquet - формат, который предполагает запись не в строки, а в столбцы. То есть по сути не в конец файла, а в середину, а это невозможно делать
в HDFS, поэтому образуется большое количество файлов при записи из стриминга. Ещё структура приходящих данных должна быть определена зарание, и если из
стриминга придут данные, структура которых отличается, то получим ошибку.
Когда мы размещаем таблицу в паркет-файле, то сначала в этот файл записывается первая колонка этой таблицы, затем вторая и т.д. Плюс метадата. И всё это нельзя изменить.
Поэтому когда появляются новые данные (стриминг) нельзя увеличить существующую группу (row group), можно только добавить новую группу, что влечёт за собой необходимость
аггрегации.
